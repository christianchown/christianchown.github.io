(window.webpackJsonponedrive=window.webpackJsonponedrive||[]).push([[0],[,,,,,function(e,t,n){e.exports=n.p+"static/media/folder.fa19bc21.svg"},,function(e,t,n){e.exports=n(22)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(4),o=n.n(c),i=(n(12),n(1));n(13);function s(e){var t=e.loggedIn;return r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"header__wrap"},r.a.createElement("div",{className:"header__contents"},r.a.createElement("h1",{className:"header__title"},"One Drive browser"),t&&r.a.createElement("a",{href:"./",className:"header__logout"},"Logout"))))}function u(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1];Object(a.useEffect)((function(){var e=new URLSearchParams(window.location.hash.substring(1));e.get("error_description")&&c(e.get("error_description"))}),[]);var o=Object(a.useCallback)((function(){window.open("https://login.live.com/oauth20_authorize.srf?client_id=e5030219-3594-4bb3-8b14-d68501517da6&scope=onedrive.readwrite&response_type=token&redirect_uri=".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname)),window.close()}),[]);return n?r.a.createElement("p",{className:"app__text"},n):r.a.createElement("button",{type:"button",className:"app__button",onClick:o},"Log in to your One Drive account")}var l=n(2),d={},m=r.a.createContext(d);n(14);function f(e){var t=e.type,n=e.children;return r.a.createElement("div",{className:"callout callout--".concat(t)},n)}n(15);function h(){return r.a.createElement("div",{className:"lds-hourglass"})}n(16);function p(e){var t=e.currentDir,n=e.setCurrentDir,a=t.split("/");function c(e){return function(){n(a.slice(0,e+1).join("/"))}}return r.a.createElement("nav",{className:"breadcrumb"},r.a.createElement("ul",{className:"breadcrumb__wrap"},r.a.createElement("p",{className:"breadcrumb__text"},"You are here:"),a.map((function(e,t,n){return r.a.createElement("li",{className:"breadcrumb__item",key:"crumb".concat(t)},t===n.length-1?0===t?"/":e:r.a.createElement("button",{type:"button",className:"breadcrumb__link",onClick:c(t)},0===t?"/":e))}))))}var b=n(5),v=n.n(b),g=["avi","mkv","mov","mpg","mpeg","mp4","pdf","jpg"];var _={a:"a".charCodeAt(0),z:"z".charCodeAt(0),A:"A".charCodeAt(0),Z:"Z".charCodeAt(0),zero:"0".charCodeAt(0),nine:"9".charCodeAt(0)};function w(e,t){return function(e){return g.reduce((function(e,t){return e.length>t.length+1&&e.substring(e.length-t.length)===t&&"."!==e.charAt(e.length-t.length-1)?"".concat(e.substring(0,e.length-t.length),".").concat(t):e}),e)}(function(e){return g.reduce((function(e,t){var n=e.lastIndexOf(".".concat(t));return e.length>t.length+1&&n===e.length-t.length-1?"".concat(e.substring(0,e.length-t.length-1)).concat(t):e}),e)}(e).split("").map((function(e){var n=e.charCodeAt(0);if(n>=_.a&&n<=_.z){for(n+=t;n>_.z;)n-=26;for(;n<_.a;)n+=26}else if(n>=_.A&&n<=_.Z){for(n+=t;n>_.Z;)n-=26;for(;n<_.A;)n+=26}else if(1===Math.abs(t)&&n>=_.zero&&n<=_.nine){for(n+=t;n>_.nine;)n-=10;for(;n<_.zero;)n+=10}return String.fromCharCode(n)})).join(""))}function E(e,t){var n=e.split("/");return n.map((function(e,a){return a===n.length-1?w(e,t):e})).join("/")}n(17);function O(e){var t=e.child,n=e.clickFolder,a=e.decode;return r.a.createElement("div",{className:"folder"},r.a.createElement("button",{className:"folder__name",type:"button",onClick:n},r.a.createElement("img",{className:"folder__icon",src:v.a,width:"16",height:"16",alt:"Folder"}),a&&t.name?E(t.name,1):t.name))}var j=n(6);function y(e){if(0===e)return"Empty";var t=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toFixed(2)+" "+" KMGTP".charAt(t)+"B"}n(19);function N(e){var t=e.progress,n=e.total,a=e.cancel;return r.a.createElement("div",{className:"progress"},r.a.createElement("div",{className:"progress__bar",style:{width:"".concat(100*t/n,"%")}}),r.a.createElement("p",{className:"progress__text"},y(t)),r.a.createElement("button",{type:"button",className:"progress__cancel",onClick:a},"X"))}n(20);function k(e){var t=e.child,n=e.decode,c=e.currentDir,o=e.download,s=Object(a.useState)(!1),u=Object(i.a)(s,2),l=u[0],d=u[1],m=Object(a.useState)(0),f=Object(i.a)(m,2),h=f[0],p=f[1],b=Object(a.useRef)(),v=Object(a.useState)(void 0),g=Object(i.a)(v,2),_=g[0],w=g[1],O=n&&t.name?E(t.name,1):t.name;return Object(a.useEffect)((function(){_&&new Promise((function(e,n){b.current=new ReadableStream({start:function(a){var r=0;!function c(){_.read().then((function(o){var i=o.done,s=o.value;i?(p(t.size||r),d(!1),w(void 0),b.current?(a.close(),e(new Response(b.current))):n("Cancelled")):(r+=s.byteLength,p(r),a.enqueue(s),c())}))}()}})})).then((function(e){return e.blob()})).then((function(e){Object(j.saveAs)(e,O)})).catch((function(){}))}),[t.size,O,_]),r.a.createElement("div",{className:"file"},l?r.a.createElement("span",{className:"file__downloading"},O):r.a.createElement("button",{type:"button",className:"file__link",onClick:function(){d(!0),o("".concat(c,"/").concat(t.name),w)}},O),r.a.createElement("div",{className:"file__download"},_&&r.a.createElement(N,{progress:h,total:t.size||0,cancel:function(){_&&(b.current&&(b.current.cancel(),b.current=void 0),_.cancel())}})),r.a.createElement("span",{className:"file__size"},y(t.size||0)))}var C,A=(C=function(e){return"https://api.onedrive.com/v1.0/drive/root:".concat(escape(e),":/children")},function(e,t){return function(n,a){return fetch(C(n),{method:"get",headers:new Headers({Authorization:"Bearer ".concat(e.access_token)})}).then((function(e){200!==e.status?t("".concat(n," returned a status of ").concat(e.status)):e.json().then((function(e){return a(e)}))}))}});function z(e,t){return function(n,a){return fetch(function(e){return"https://api.onedrive.com/v1.0/drive/root:".concat(escape(e),":/content")}(n),{method:"get",headers:new Headers({Authorization:"Bearer ".concat(e.access_token)})}).then((function(e){return 200===e.status&&e.body?a(e.body.getReader()):302!==e.status?t("".concat(n," returned a status of ").concat(e.status)):window.open(e.headers.get("Location")),Promise.resolve()}))}}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function S(e){var t=e.auth,n=Object(a.useState)(void 0),c=Object(i.a)(n,2),o=c[0],s=c[1],u=Object(a.useState)(!1),b=Object(i.a)(u,2),v=b[0],g=b[1],_=Object(a.useState)("/"),w=Object(i.a)(_,2),E=w[0],j=w[1],y=Object(a.useState)(d),N=Object(i.a)(y,2),C=N[0],S=N[1],D=A(t,s),x=z(t,s),L=C[E];function M(e){return function(){j("".concat("/"===E?"":E,"/").concat(e.name))}}return Object(a.useEffect)((function(){L||D(E,(function(e){S(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},C,Object(l.a)({},E,e.value)))}))}),[L,E,C,D]),r.a.createElement(m.Provider,{value:C},o&&r.a.createElement(f,{type:"error"},o),r.a.createElement("div",{className:"app__controls"},r.a.createElement(p,{currentDir:E,setCurrentDir:j}),r.a.createElement("button",{type:"button",className:"app__button",onClick:function(){g(!v)}},v?"Actual name":"Decoded")),!L&&r.a.createElement(h,null),L&&!L.length&&r.a.createElement("p",{className:"app_text"},"No items"),L&&L.map((function(e){return r.a.createElement(r.a.Fragment,{key:e.id},e.folder&&r.a.createElement(O,{child:e,clickFolder:M(e),decode:v}),e.file&&r.a.createElement(k,{child:e,decode:v,currentDir:E,download:x}))})))}var D={access_token:void 0,user_id:void 0},x=r.a.createContext(D);n(21);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement((function(){var e=Object(a.useState)(D),t=Object(i.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){var e=new URLSearchParams(window.location.hash.substring(1)),t=Object.keys(D);t.some((function(t){return!e.get(t)}))||c(t.reduce((function(t,n){return t[n]=e.get(n),t}),{}))}),[]),r.a.createElement("div",{className:"app"},r.a.createElement(x.Provider,{value:n},r.a.createElement(s,{loggedIn:!!n.access_token}),r.a.createElement("div",{className:"app__body"},!n.access_token&&r.a.createElement(u,null),n.access_token&&r.a.createElement(S,{auth:n}))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[7,1,2]]]);
//# sourceMappingURL=main.1231d59d.chunk.js.map